@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "formSpouseLanguage" }))
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        @*@Html.ValidationSummary(false, "", new { @class = "text-danger" })*@
        <div class="card mt-4">
            <div class="card-header" style="background-color:#fff">
                LANGUAGES KNOWN
            </div>
            <div class="card-body">
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <Label class="control-label">Language</Label>
                        <input type="text" name="laSLanguage" id="laSLanguage_1" required title="Enter Language" class="form-control" placeholder="Language">
                    </div>
                    <div class="form-group col-md-1">
                        <Label class="control-label pb-4" style="width:100%"></Label>
                        <label>
                            Read
                            <input type="checkbox" name="laSRead" id="laSRead_1" class="custom-checkbox">
                        </label>
                    </div>
                    <div class="form-group col-md-1">
                        <Label class="control-label pb-4" style="width:100%"></Label>
                        <label>
                            Write
                            <input type="checkbox" name="laSWrite" id="laSWrite_1" class="custom-checkbox">
                        </label>
                    </div>
                    <div class="form-group col-md-1">
                        <Label class="control-label pb-4" style="width:100%"></Label>
                        <label>
                            Speak
                            <input type="checkbox" name="laSSpeak" id="laSSpeak_1" class="custom-checkbox">
                        </label>
                    </div>
                    <div class="form-group col-md-2">
                        <Label class="control-label pb-3" style="width:100%"></Label>
                        <button type="button" class="add-SpouseLanguage btn btn-outline-primary btn-sm"><i class="fa fa-plus"></i></button>
                        <button type="button" class="remove-SpouseLanguage btn btn-outline-danger ml-2 btn-sm"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div id="new_laS"></div>
                <input type="hidden" value="1" id="total_laS">

                <div class="form-group mt-4 text-center">
                    <div class="col-md-offset-2 col-md-10">
                        <input type="button" value="Submit" onclick="addSpouseLanguages()" class="btn btn-primary" />
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<script>
    // #region Language
    function storeSpouseLanguage() {
        let ttlla = $('#total_laS').val();
        let languages = [];
        for (i = 1, j = 0; i <= ttlla; i++ , j++) {
            languages[j] = {
                Language: $('#laSLanguage_' + i).val(),
                Read: document.getElementById('laSRead_' + i).checked,
                Write: document.getElementById('laSWrite_' + i).checked,
                Speak: document.getElementById('laSSpeak_' + i).checked,
                SpouseId: $('#hdnSpouseId').val(),
            };
        }
        return languages;
    }

    $('.add-SpouseLanguage').on('click', addSpouseLanguage);
    $('.remove-SpouseLanguage').on('click', removeSpouseLanguage);
    function addSpouseLanguage() {
        let new_la_no = parseInt($('#total_laS').val()) + 1;
        let new_inputLa = `<div id="Language_${new_la_no}" class="form-row">
                               <div class="form-group col-md-4">
                                   <input type="text" name="laSLanguage" id="laSLanguage_${new_la_no}" required title="Enter Language Known" class="form-control" placeholder="Language">
                               </div>
                               <div class="form-group col-md-1">
                                   <label>Read
                                   <input type="checkbox" name="laSRead" id="laSRead_${new_la_no}" class="custom-checkbox"></label>
                               </div>
                               <div class="form-group col-md-1">
                                   <label>Write
                                   <input type="checkbox" name="laSWrite" id="laSWrite_${new_la_no}" class="custom-checkbox"></label>
                               </div>
                               <div class="form-group col-md-1">
                                   <label>Speak
                                   <input type="checkbox" name="laSSpeak" id="laSSpeak_${new_la_no}" class="custom-checkbox"></label>
                               </div>
                           </div>`
        $('#new_laS').append(new_inputLa);
        $('#total_laS').val(new_la_no);
    }
    function removeSpouseLanguage() {
        let last_la_no = $('#total_laS').val();

        if (last_la_no > 1) {
            $('#Language_' + last_la_no).remove();
            $('#total_laS').val(last_la_no - 1);
        }
    }
    // #endregion

    function addSpouseLanguages() {
        if ($("#formSpouseLanguage").valid()) {
            let languageList = storeSpouseLanguage();
            let languages = JSON.stringify(languageList);
            $.ajax({
                type: 'post',
                url: '/api/courseMembers/SpouseLanguage',
                data: languages,
                contentType: "application/json; charset=utf-8",
                datatype: 'json',
                success: function (data, textStatus, xhr) {
                    toastr.info(textStatus);
                    displayTab('SpousePartial');
                },
                error: function () {
                    toastr.error('Operation Failed!');
                }
            });
        }
    }
</script>