@model NDCWeb.Areas.Member.View_Models.PassportDetailCrtVM

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

<div class="form-horizontal">
    @Html.ValidationSummary(false, "", new { @class = "text-danger" })
    <div class="card mt-4">
        <div class="card-header" style="background-color:#fff">
            PASSPORT DETAILS (SELF)
        </div>
        <div class="card-body">
            <p class="label-info text-danger">For Indian Course Members only (Upload the following)</p>
            <div class="form-row">
                <div class="form-group col-md-5">
                    <label class="control-label"><b>Holding Diplomatic or Official Passport</b></label>
                    <div class="form-inline">
                        <label class="containerchk col-md-1">
                            Yes
                            <input type="radio" checked="checked" value="Yes" name="HoldingPassport">
                            <span class="checkmark"></span>
                        </label>
                        <label class="containerchk col-md-1">
                            No
                            <input type="radio" value="NO" name="HoldingPassport">
                            <span class="checkmark"></span>
                        </label>

                    </div>
                    @Html.ValidationMessageFor(model => model.HoldingPassport, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-3">
                    <Label class="control-label">Passport No</Label>
                    @Html.EditorFor(model => model.MemberPassportNo, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.MemberPassportNo, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Date of Issue</Label>
                    @Html.EditorFor(model => model.MemberPassportIssueDate, new { htmlAttributes = new { @class = "form-control datepickerJq1", @autocomplete = "off" } })
                    @Html.ValidationMessageFor(model => model.MemberPassportIssueDate, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Valid Upto</Label>
                    @Html.EditorFor(model => model.MemberPassportValidUpto, new { htmlAttributes = new { @class = "form-control datepickerJq1", @autocomplete = "off" } })
                    @Html.ValidationMessageFor(model => model.MemberPassportValidUpto, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="citizencountry">Full Name</label>
                    <input type="text" class="form-control" />
                </div>
                <div class="form-group col-md-2">
                    <label for="citizencountry">Passport Type</label>
                    @Html.DropDownListFor(model => model.MemberPassportType, (IEnumerable<SelectListItem>)ViewBag.PassportType, "-- Select --", htmlAttributes: new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.MemberPassportType, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <label for="citizencountry">Country that issued your passport</label>
                    <input type="text" class="form-control" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-3">
                    <label>Upload Passport Image (Front)</label>
                    <input id="mbrPassportPicfile" type="file" title="Upload Your Self Passport" name="mbrPassportPicfile" onchange="imgValidateEdit('mbrPassportPicfile', 'MemberPassportImgPath')" class="uploadify-button form-control-file" accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    @Html.EditorFor(model => model.MemberPassportImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })
                </div>
                <div class="form-group col-md-3">
                    <label>Upload passport Images (Back)</label>
                    <input id="mbrPassportPicfile" type="file" title="Upload Your Self Passport" name="mbrPassportPicfile" onchange="imgValidateEdit('mbrPassportPicfile', 'MemberPassportImgPath')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    @Html.EditorFor(model => model.MemberPassportImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })
                </div>
            </div>

        </div>
    </div>
    <div class="card mt-4">
        <div class="card-header" style="background-color:#fff">
            PASSPORT DETAILS OF SPOUSE
        </div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group col-md-3">
                    <Label class="control-label">Passport No</Label>
                    @Html.EditorFor(model => model.SpousePassportNo, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.SpousePassportNo, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Date of Issue</Label>
                    @Html.EditorFor(model => model.SpousePassportIssueDate, new { htmlAttributes = new { @class = "form-control datepickerJq1", @autocomplete = "off" } })
                    @Html.ValidationMessageFor(model => model.SpousePassportIssueDate, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Valid Upto</Label>
                    @Html.EditorFor(model => model.SpousePassportValidUpto, new { htmlAttributes = new { @class = "form-control datepickerJq1", @autocomplete = "off" } })
                    @Html.ValidationMessageFor(model => model.SpousePassportValidUpto, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="citizencountry">Full Name</label>
                    <input type="text" class="form-control" />
                </div>
                <div class="form-group col-md-2">
                    <label for="citizencountry">Passport Type</label>
                    @Html.DropDownListFor(model => model.SpousePassportType, (IEnumerable<SelectListItem>)ViewBag.PassportType, "-- Select --", htmlAttributes: new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.SpousePassportType, "", new { @class = "text-danger" })
                </div>
                <div class="form-group col-md-2">
                    <label for="citizencountry">Country that issued your passport</label>
                    <input type="text" class="form-control" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="passport_self">Upload passport image (Front)</label>
                    <input id="spousePassportPicfile" type="file" title="Upload Your Spouse Passport" name="spousePassportPicfile" onchange="imgValidateEdit('spousePassportPicfile', 'SpousePassportImgPath')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    @Html.EditorFor(model => model.SpousePassportImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })
                </div>
                <div class="form-group col-md-3">
                    <label for="passport_self">Upload passport image (Back)</label>
                    <input id="spousePassportPicfile" type="file" title="Upload Your Spouse Passport" name="spousePassportPicfile" onchange="imgValidateEdit('spousePassportPicfile', 'SpousePassportImgPath')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    @Html.EditorFor(model => model.SpousePassportImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })
                </div>
            </div>

        </div>
    </div>
    <div class="card mt-4">
        <div class="card-header" style="background-color:#fff">
            PASSPORT DETAILS OF CHILDREN
        </div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group col-md-3">
                    <Label class="control-label">Passport No</Label>
                    <input type="text" name="chPPassportNo" id="chPPassportNo_1" required title="Enter Child Passport No" class="form-control" placeholder="Passport No">
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Date of Issue</Label>
                    <input type="text" name="chPIssueDate" id="chPIssueDate_1" required title="Enter Child Date of Issue" class="form-control datepickerJq1" autocomplete="off" placeholder="Issue Date">
                </div>
                <div class="form-group col-md-2">
                    <Label class="control-label">Valid Upto</Label>
                    <input type="text" name="chPValidUpto" id="chPValidUpto_1" required title="Enter Child Valid Upto" class="form-control datepickerJq1" autocomplete="off" placeholder="Valid Upto">
                </div>
                <div class="form-group col-md-3">
                    <Label class="control-label">Full Name</Label>
                    <input type="text" name="chPFullName" id="chPFullName_1" required title="Enter Child Full Name" class="form-control" autocomplete="off" placeholder="Full Name">
                </div>
                <div class="form-group col-md-2">
                    <label>Passport Type</label>
                    <select class="form-control" id="chPPassportType_1" required title="Enter Child Passport Type">
                        <option disabled selected>--Select--</option>
                        <option value="Diplomatic">Diplomatic</option>
                        <option value="Official">Official</option>
                        <option value="Service">Service</option>
                        <option value="Personal">Personal</option>
                    </select>
                </div>
                <div class="form-group col-md-3">
                    <Label class="control-label">Country</Label>
                    <input type="text" name="chPCountry" id="chPCountry_1" required title="Enter Country Name" class="form-control" autocomplete="off" placeholder="Country Name">
                </div>
                <div class="form-group col-md-4">
                    <label>Upload passport image (Front)</label>
                    <input id="chPPassportPicfile_1" type="file" required title="Upload Child Passport Images" name="chPPassportPicfile" onchange="imgValidate('chPPassportPicfile_1', 'hdnChildPImgPath_1')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    <input type="hidden" value="#" id="hdnChildPImgPath_1">
                    @*@Html.EditorFor(model => model.MemberImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })*@
                </div>
                <div class="form-group col-md-4">
                    <label>Upload passport image (Back)</label>
                    <input id="chPPassportPicfileBack_1" type="file" required title="Upload Child Passport Images" name="chPPassportPicfileBack" onchange="imgValidate('chPPassportPicfileBack_1', 'hdnChildPImgPath_1')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                    <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                    <input type="hidden" value="#" id="hdnChildPBackImgPath_1">
                    @*@Html.EditorFor(model => model.MemberImgPath, new { htmlAttributes = new { @class = "form-control", @style = "display: none" } })*@
                </div>
            </div>
            <div id="new_chP"></div>
            <input type="hidden" value="1" id="total_chP">
            <div class="form-row">
                <div class="form-group col-md-6">
                    <Label class="control-label" style="width:100%">Add/Remove</Label>
                    <button type="button" class="add-ChildPassport btn btn-outline-primary btn-sm"><i class="fa fa-plus"></i>Add</button>
                    <button type="button" class="remove-ChildPassport btn btn-outline-danger ml-2 btn-sm"><i class="fa fa-minus"></i>Remove</button>
                </div>
            </div>

        </div>
    </div>
    <div class="card mt-4">
        <div class="card-header" style="background-color:#fff">
            <span class="font-weight-bold" style="color:red">Important</span>
        </div>
        <div class="card-body text-justify">
            <p id="passport_instruction_indian">
                <u><b>Instructions for Indian Officers</b></u><br />
                Indian Officers in possession of diplomatic/official passport are requested to carry the same for the course. If the officer is in possession of ordinary passport in
                addition to diplomatic/official passport they are required to deposit personal passports with the college. It is also recomended that their spouse should be in
                possession of a valid ordinary passport for accompanying the course member abroad should an occasion arise. Since preparation of a new passport would take about 30-45 days,
                one may apply and obtain an ordanary passport for the spouse at the earliest. It may be noted that NDC does not have any arrangement for preparation of ordinary passport
                either for the officer or his/her spouse. Passport details are required to be given to NDC by end January.
            </p>
        </div>
    </div>
    <div class="form-group mt-4 text-center">
        <div class="col-md-offset-2 col-md-10">
            <input type="button" id="btnSavePassport" value="Submit" onclick="addPassport()" class="btn btn-primary btn-lg" />
        </div>
    </div>
</div>
}

@Scripts.Render("~/bundles/jqueryval")
<script>
    $(document).ready(function () {
        getDatepickerf1('.datepickerJq1');
    });
    // #region children
    function storeChildPassport() {
        let ttlla = $('#total_chP').val();
        let childrenPassport = [];
        for (i = 1, j = 0; i <= ttlla; i++ , j++) {
            childrenPassport[j] = {
                PassportNo: $('#chPPassportNo_' + i).val(),
                PassportIssueDate: $('#chPIssueDate_' + i).val(),
                PassportValidUpto: $('#chPValidUpto_' + i).val(),
                PassportType: $('#chPPassportType_' + i).val(),
                PassportImgPath: $('#hdnChildPImgPath_' + i).val() || '#',
            };
        }
        return childrenPassport;
    }

    $('.add-ChildPassport').on('click', addChildPassport);
    $('.remove-ChildPassport').on('click', removeChildPassport);
    function addChildPassport() {
        let new_la_no = parseInt($('#total_chP').val()) + 1;
        let new_inputLa = `<div id="ChildPassport_${new_la_no}" class="form-row">
                               <div class="form-group col-md-3">
                                   <Label class="control-label">Passport No</Label>
                                   <input type="text" name="chPPassportNo" id="chPPassportNo_${new_la_no}" required title="Enter Child Passport No" class="form-control" placeholder="Passport No">
                               </div>
                               <div class="form-group col-md-2">
                                   <Label class="control-label">Date of Issue</Label>
                                   <input type="text" name="chPIssueDate" id="chPIssueDate_${new_la_no}" required title="Enter Child Date of Issue" class="form-control datepickerJq1" autocomplete = "off" placeholder="Issue Date">
                               </div>
                               <div class="form-group col-md-2">
                                   <Label class="control-label">Valid Upto</Label>
                                   <input type="text" name="chPValidUpto" id="chPValidUpto_${new_la_no}" required title="Enter Child Valid Upto" class="form-control datepickerJq1" autocomplete = "off" placeholder="Valid Upto">
                               </div>
                                <div class="form-group col-md-3">
                                   <Label class="control-label">Full Name</Label>
                                   <input type="text" name="chPFullName" id="chPFullName_${new_la_no}" required title="Enter Child Full Name" class="form-control" autocomplete = "off" placeholder="Full Name">
                               </div>
                               <div class="form-group col-md-2">
                                   <label>Passport Type</label>
                                   <select class="form-control" id="chPPassportType_${new_la_no}" required title="Enter Child Passport Type">
                                       <option disabled selected>--Select--</option>
                                       <option value="Diplomatic">Diplomatic</option>
                                       <option value="Official">Official</option>
                                       <option value="Service">Service</option>
                                       <option value="Personal">Personal</option>
                                   </select>
                               </div>
                                <div class="form-group col-md-2">
                                   <Label class="control-label">Country</Label>
                                   <input type="text" name="chPCountry" id="chPCountry_${new_la_no}" required title="Enter Country Name" class="form-control" autocomplete = "off" placeholder="Country Name">
                               </div>
                               <div class="form-group col-md-4">
                                   <label>Upload passport image (Front)</label>
                                   <input id="chPPassportPicfile_${new_la_no}" type="file" required title="Upload Child Passport Images" name="chPPassportPicfile" onchange="imgValidate('chPPassportPicfile_${new_la_no}', 'hdnChildPImgPath_${new_la_no}')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                                   <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                                   <input type="hidden" value="#" id="hdnChildPImgPath_${new_la_no}">
                               </div>
                                <div class="form-group col-md-4">
                                   <label>Upload passport image (Back)</label>
                                   <input id="chPPassportPicfileBack_${new_la_no}" type="file" required title="Upload Child Passport Images" name="chPPassportPicfileBack" onchange="imgValidate('chPPassportPicfileBack_${new_la_no}', 'hdnChildPImgPath_${new_la_no}')" class="uploadify-button form-control-file"  accept="image/jpeg,image/png" />
                                   <p class="text-info">Max size 250 KB, File Type (.jpg, .jpeg, .png)</p>
                                   <input type="hidden" value="#" id="hdnChildPBackImgPath_${new_la_no}">
                               </div>
                           </div>`
        $('#new_chP').append(new_inputLa);
        $('#total_chP').val(new_la_no);
        getDatepickerf1('.datepickerJq1');
    }
    function removeChildPassport() {
        let last_la_no = $('#total_chP').val();

        if (last_la_no > 1) {
            $('#ChildPassport_' + last_la_no).remove();
            $('#total_chP').val(last_la_no - 1);
        }
    }
    // #endregion

    function fillPassport() {
        let passport = {
            HoldingPassport: $("#HoldingPassport").val(),
            MemberPassportNo: $("#MemberPassportNo").val(),
            MemberPassportIssueDate: $("#MemberPassportIssueDate").val(),
            MemberPassportValidUpto: $("#MemberPassportValidUpto").val(),
            MemberPassportType: $("#MemberPassportType").val(),
            SpousePassportNo: $("#SpousePassportNo").val(),
            SpousePassportIssueDate: $("#SpousePassportIssueDate").val(),
            SpousePassportValidUpto: $("#SpousePassportValidUpto").val(),
            SpousePassportType: $("#SpousePassportType").val(),

            MemberPassportImgPath: $("#MemberPassportImgPath").val() || '#',
            SpousePassportImgPath: $("#SpousePassportImgPath").val() || '#',

            iChildrenPassports: storeChildPassport(),
        }
        return passport;
    }
    function addPassport() {
        if ($("form").valid()) {
            let passport = fillPassport();
            $.ajax({
                type: 'post',
                url: '/api/courseMembers/Passport',
                data: passport,
                datatype: 'json',
                success: function (data, textStatus, xhr) {
                    toastr.info(textStatus);
                    displayTab('PassportPartial');
                },
                error: function () {
                    alert('Operation Failed!')
                }
            })
        }
    }
</script>